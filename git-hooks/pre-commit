#!/usr/bin/env bash
# Hook pre-commit mínimo: ejecuta formateo/lint y escaneo de secretos (si están disponibles).
# no bloquea el commit (solo muestra advertencias)

echo "Ejecutando verificaciones de pre-commit..."

# 1) Ejecutar black 
if command -v black >/dev/null 2>&1; then
  black --check .
else
  echo "black no está instalado; se omite la verificación de formato."
fi

# 2) Ejecutar flake8 
if command -v flake8 >/dev/null 2>&1; then
  flake8 || echo "flake8 encontró algunos detalles. (Solo advertencia en el Sprint 1)"
else
  echo "flake8 no está instalado; se omite la verificación de lint."
fi

# 3) Ejecutar gitleaks para detectar secretos
if command -v gitleaks >/dev/null 2>&1; then
  gitleaks detect --source . || echo "gitleaks detectó posibles secretos (advertencia en el Sprint 1)."
else
  echo "gitleaks no está instalado; se omite el escaneo de secretos."
fi

# Fin: permitir que el commit continúe.
exit 0
